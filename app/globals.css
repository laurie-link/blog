@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* 默认暗色主题 */
  :root {
    --foreground-rgb: 255, 255, 255;
    --background-start-rgb: 15, 23, 42;
    --background-end-rgb: 15, 23, 42;
  }

  /* 明亮主题 */
  [data-theme='light'] {
    --foreground-rgb: 15, 23, 42;
    --background-start-rgb: 255, 255, 255;
    --background-end-rgb: 255, 255, 255;
  }

  /* 暗色主题（显式声明） */
  [data-theme='dark'] {
    --foreground-rgb: 255, 255, 255;
    --background-start-rgb: 15, 23, 42;
    --background-end-rgb: 15, 23, 42;
  }

  body {
    color: rgb(var(--foreground-rgb));
    background: linear-gradient(to bottom, transparent, rgb(var(--background-end-rgb))) rgb(var(--background-start-rgb));
  }

  code {
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 0.9em;
  }
}

@layer components {
  /* Markdown 样式 - 使用组合类减少CSS大小 */
  .markdown-body {
    @apply text-base max-w-none;
  }

  .markdown-body h1 {
    @apply text-4xl font-bold mt-8 mb-6 text-gray-900 dark:text-white border-b-4 border-primary-500 pb-3;
  }

  .markdown-body h2 {
    @apply text-3xl font-bold mt-8 mb-4 text-gray-900 dark:text-white border-b-2 border-gray-300 dark:border-gray-700 pb-2;
  }

  .markdown-body h3 {
    @apply text-2xl font-bold mt-6 mb-3 text-gray-900 dark:text-white;
  }

  .markdown-body h4 {
    @apply text-xl font-bold mt-4 mb-2 text-gray-900 dark:text-white;
  }

  .markdown-body p {
    @apply mb-4 leading-relaxed text-gray-700 dark:text-gray-300 text-lg;
  }

  .markdown-body a {
    @apply text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 underline decoration-2 underline-offset-2 transition-colors;
  }

  .markdown-body ul {
    @apply mb-6 ml-6 space-y-2 list-disc;
  }

  .markdown-body ol {
    @apply mb-6 ml-6 space-y-2 list-decimal;
  }

  .markdown-body li {
    @apply text-gray-700 dark:text-gray-300 leading-relaxed pl-2;
  }

  .markdown-body code {
    @apply px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-primary-600 dark:text-primary-400 rounded text-sm font-mono border border-gray-200 dark:border-gray-700;
  }

  .markdown-body pre {
    @apply mb-6 p-4 bg-gray-900 dark:bg-gray-950 rounded-lg overflow-x-auto border border-gray-700 shadow-lg;
  }

  .markdown-body pre code {
    @apply px-0 py-0 bg-transparent text-gray-100 border-0 text-sm;
  }

  .markdown-body blockquote {
    @apply mb-6 pl-4 py-2 border-l-4 border-primary-500 bg-primary-50 dark:bg-gray-800 italic text-gray-700 dark:text-gray-300 rounded-r-lg;
  }

  .markdown-body table {
    @apply mb-6 min-w-full divide-y divide-gray-300 dark:divide-gray-700 border border-gray-300 dark:border-gray-700 rounded-lg overflow-hidden;
  }

  .markdown-body thead {
    @apply bg-gray-100 dark:bg-gray-800;
  }

  .markdown-body th {
    @apply px-4 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white;
  }

  .markdown-body td {
    @apply px-4 py-3 text-sm text-gray-700 dark:text-gray-300;
  }

  .markdown-body img {
    @apply mb-6 rounded-lg shadow-lg max-w-full md:max-w-3xl max-h-[800px] h-auto mx-auto border border-gray-200 dark:border-gray-700;
  }

  .markdown-body strong {
    @apply font-bold text-gray-900 dark:text-white;
  }

  .markdown-body hr {
    @apply my-8 border-t-2 border-gray-300 dark:border-gray-700;
  }
}

/* Notion Bookmark 样式 - 在layer外面以确保被应用 */
.notion-bookmark {
    border: 1px solid rgb(229, 231, 235);
    border-radius: 0.5rem;
    overflow: hidden;
    box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    transition: box-shadow 0.3s;
    margin: 1.5rem 0;
    background-color: white;
  }

  .notion-bookmark:hover {
    box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  }

  [data-theme='dark'] .notion-bookmark,
  :root:not([data-theme='light']) .notion-bookmark {
    border-color: rgb(55, 65, 81);
    background-color: rgb(31, 41, 55);
  }

  .notion-bookmark a {
    text-decoration: none !important;
    color: inherit !important;
    display: block;
  }

  .notion-bookmark > a > div {
    padding: 1rem;
    display: flex;
    gap: 0.75rem;
    justify-content: space-between;
    align-items: center;
    transition: background-color 0.3s;
  }

  .notion-bookmark > a > div:hover {
    background-color: rgb(249, 250, 251);
  }

  [data-theme='dark'] .notion-bookmark > a > div:hover,
  :root:not([data-theme='light']) .notion-bookmark > a > div:hover {
    background-color: rgb(55, 65, 81);
  }

  .notion-bookmark > a > div > div:first-child {
    flex: 1;
    min-width: 0;
  }

  .notion-bookmark > a > div > div:first-child > div:first-child {
    font-weight: 600;
    color: rgb(17, 24, 39);
    margin-bottom: 0.25rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  [data-theme='dark'] .notion-bookmark > a > div > div:first-child > div:first-child,
  :root:not([data-theme='light']) .notion-bookmark > a > div > div:first-child > div:first-child {
    color: white;
  }

  .notion-bookmark > a > div > div:first-child > div:last-child {
    font-size: 0.75rem;
    color: rgb(107, 114, 128);
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  [data-theme='dark'] .notion-bookmark > a > div > div:first-child > div:last-child,
  :root:not([data-theme='light']) .notion-bookmark > a > div > div:first-child > div:last-child {
    color: rgb(156, 163, 175);
  }

  .notion-bookmark > a > div > div:last-child {
    flex-shrink: 0;
    font-size: 1.5rem;
  }

  .notion-bookmark img {
    width: 1.75rem !important;
    height: 1.75rem !important;
    margin: 0 !important;
    border: none !important;
    box-shadow: none !important;
    object-fit: contain;
  }

  /* 链接卡片样式 */
  .plain-link-card {
    margin: 1.5rem 0;
  }

  .plain-link-card a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: linear-gradient(to right, rgb(240, 249, 255), rgb(219, 234, 254));
    border: 2px solid rgb(191, 219, 254);
    border-radius: 0.75rem;
    transition: all 0.3s;
    text-decoration: none !important;
  }

  .plain-link-card a:hover {
    border-color: rgb(147, 197, 253);
    box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  }

  [data-theme='dark'] .plain-link-card a,
  :root:not([data-theme='light']) .plain-link-card a {
    background: linear-gradient(to right, rgba(12, 74, 110, 0.2), rgba(29, 78, 216, 0.2));
    border-color: rgb(30, 58, 138);
  }

  [data-theme='dark'] .plain-link-card a:hover,
  :root:not([data-theme='light']) .plain-link-card a:hover {
    border-color: rgb(37, 99, 235);
  }

  .plain-link-card .link-icon {
    width: 1.25rem;
    height: 1.25rem;
    flex-shrink: 0;
    color: rgb(37, 99, 235);
  }

  [data-theme='dark'] .plain-link-card .link-icon,
  :root:not([data-theme='light']) .plain-link-card .link-icon {
    color: rgb(96, 165, 250);
  }

  .plain-link-card .link-text {
    flex: 1;
    font-weight: 500;
    color: rgb(55, 65, 81);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  [data-theme='dark'] .plain-link-card .link-text,
  :root:not([data-theme='light']) .plain-link-card .link-text {
    color: rgb(209, 213, 219);
  }

  .plain-link-card .external-icon {
    width: 1rem;
    height: 1rem;
    flex-shrink: 0;
    color: rgb(107, 114, 128);
  }

[data-theme='dark'] .plain-link-card .external-icon,
:root:not([data-theme='light']) .plain-link-card .external-icon {
  color: rgb(156, 163, 175);
}
